# Instructions Détaillées pour Cursor - Étape 2.1.3

**Phase:** 2 - Collecte  
**Étape:** 2.1 - Module Formulaires de Don  
**Fonctionnalité:** 2.1.3 - Form Builder (Créateur de Formulaire)  
**Prérequis:** Étape 2.1.2 complétée

---

## Contexte

Nous créons l'interface la plus complexe et la plus importante de la Phase 2 : le créateur de formulaires de don. Cette interface doit être un éditeur visuel (Form Builder) qui permet aux utilisateurs de créer des formulaires de don personnalisés en 6 étapes, avec une preview en temps réel.

**Référence cahier des charges:** Section 5.2.1 - Création de Formulaires Personnalisables

---

## 1. Pages du Form Builder

**Créer:** `/apps/web/app/[locale]/dashboard/formulaires/new/page.tsx`  
**Créer:** `/apps/web/app/[locale]/dashboard/formulaires/[id]/edit/page.tsx`

### Structure de la Page

Layout en 2 colonnes :

**Colonne gauche (2/3) :**
- **Stepper** en 6 étapes (cliquable pour naviguer)
- **Contenu de l'étape** actuelle
- **Boutons de navigation** (Précédent, Suivant, Enregistrer le brouillon, Publier)

**Colonne droite (1/3) :**
- **Preview en temps réel** du formulaire
- Bouton pour switcher entre vue Desktop et Mobile

### Stepper en 6 Étapes

1.  **Informations**
2.  **Montants**
3.  **Champs**
4.  **Design**
5.  **Messages**
6.  **Paramètres**

---

## 2. Contenu de Chaque Étape

### Étape 1 : Informations

- **Titre du formulaire** (input, requis)
- **Description** (textarea, optionnel)
- **Slug** (input, auto-généré à partir du titre, modifiable)
- **Image de couverture** (upload)

### Étape 2 : Montants

- **Type de don** (radio : Flexible, Fixe)
- **Montants suggérés** (input pour ajouter/supprimer des montants)
- **Montant minimum** (input, optionnel)
- **Montant maximum** (input, optionnel)
- **Devise** (select : CAD, USD, EUR)
- **Autoriser les dons récurrents** (toggle)
- **Fréquences disponibles** (checkboxes : Mensuel, Trimestriel, Annuel)

### Étape 3 : Champs

- **Champs obligatoires** (liste avec toggles pour activer/désactiver)
- **Champs optionnels** (liste avec toggles)
- **Champs personnalisés** (bouton "Ajouter un champ")
  - Modal pour configurer le champ (type, label, placeholder, requis, options)
- **Drag & drop** pour réorganiser l'ordre des champs

### Étape 4 : Design

- **Couleur principale** (color picker)
- **Logo** (upload)
- **Image de fond** (upload)
- **Police de caractères** (select : Inter, Lato, Roboto, etc.)
- **Style de bouton** (select : Solid, Outline, Gradient)

### Étape 5 : Messages

- **Message de bienvenue** (textarea)
- **Message de remerciement** (textarea)
- **Email de confirmation** (éditeur de texte riche)
- **Redirection après don** (input URL, optionnel)

### Étape 6 : Paramètres

- **Activer les consentements** (toggle)
- **Texte des consentements** (textarea)
- **Activer reCAPTCHA** (toggle)
- **Limite de dons** (input, optionnel)
- **Date de début** (date picker, optionnel)
- **Date de fin** (date picker, optionnel)
- **Objectif de collecte** (input, optionnel)

---

## 3. Composants Réutilisables

- **FormBuilderWizard** - Le composant principal qui gère les étapes et la navigation
- **StepIndicator** - Le stepper en 6 étapes
- **FieldEditor** - L'interface pour gérer les champs (drag & drop, ajout, suppression)
- **ColorPicker** - Sélecteur de couleur
- **ImageUploader** - Composant pour uploader logo et images
- **PreviewPanel** - Le panneau de preview en temps réel

---

## 4. Actions Serveur

- **createFormAction** - Crée un nouveau formulaire (statut DRAFT)
- **updateFormAction** - Met à jour un formulaire existant
- **uploadImageAction** - Upload une image et retourne l'URL

---

## 5. Vérifications Importantes

- ✅ Le wizard en 6 étapes est fonctionnel
- ✅ La preview se met à jour en temps réel
- ✅ La sauvegarde automatique fonctionne
- ✅ La publication met à jour le statut du formulaire
- ✅ La validation des champs est correcte

---

## 6. Prochaine Étape

Une fois cette étape complétée, Manus préparera les instructions pour **2.1.4 - Page Publique du Formulaire**.
